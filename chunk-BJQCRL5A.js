import{a as Y,b as M,c as Q,d as U,f as J,g as K,h as X,i as Z,j as ee,k as te,l as ne,m as ie,n as oe,o as se}from"./chunk-VEVOW575.js";import{b as re}from"./chunk-JJGYM6BJ.js";import{a as $}from"./chunk-JECU2FWR.js";import{h as B,j as W}from"./chunk-6RMNFVTM.js";import{$ as g,$a as u,Ca as l,Eb as V,Jb as H,Ka as y,Pa as z,Ta as b,Wb as G,Xb as R,_ as p,_b as q,a as O,ab as i,b as E,bb as r,cb as v,e as D,fb as T,gb as N,hb as x,ib as f,jb as d,lb as A,mb as L,nb as j,ob as I,pb as P,qb as h,sb as a,tb as S,ub as w}from"./chunk-IBNF2MKV.js";var le=["sessionNameInput"];function de(s,o){if(s&1&&(i(0,"div",33)(1,"strong"),a(2,"Error:"),r(),a(3),r()),s&2){let e=d();l(3),w(" ",e.sessionFormErrors.api," ")}}function ce(s,o){s&1&&(i(0,"div",34),a(1," You're editing a copy of a system-generated session. The original template stays unchanged. "),r())}function me(s,o){s&1&&(i(0,"div",50),a(1,"System Generated"),r())}function ue(s,o){if(s&1){let e=x();T(0),i(1,"div",35)(2,"button",36),f("click",function(){p(e);let n=d();return g(n.onEditClick())}),i(3,"span",37),a(4,"edit"),r()(),i(5,"button",38),f("click",function(){p(e);let n=d();return g(n.playSession())}),i(6,"span",39),a(7,"play_circle_filled"),r()(),i(8,"button",40),f("click",function(){p(e);let n=d();return g(n.deleteCurrent())}),i(9,"span",37),a(10,"delete"),r()()(),i(11,"div",41)(12,"div",42)(13,"span",43),a(14,"play_arrow"),r(),i(15,"div",44)(16,"h3",45),a(17),r(),b(18,me,2,0,"div",46),r()(),i(19,"div",47)(20,"span",48),a(21,"timer"),r(),i(22,"div",49),a(23),r()()(),N()}if(s&2){let e,t=d();l(17),S(((e=t.form.get("sessionName"))==null?null:e.value)||"Untitled Session"),l(),u("ngIf",t.currentSession==null?null:t.currentSession.isPredefined),l(5),S(t.viewTotalDurationSeconds()>0?t.formatDuration(t.viewTotalDurationSeconds()):"Untimed")}}function pe(s,o){if(s&1&&(i(0,"div",51)(1,"h2",52),a(2),r(),i(3,"p",53),a(4,"Create a new study session or update an existing one"),r()()),s&2){let e=d();l(2),S(e.editingIndex===null?"Add Session":"Edit Session")}}function ge(s,o){if(s&1&&(i(0,"div",60),a(1),r()),s&2){let e=d(2);l(),w(" ",e.sessionFormErrors.sessionName," ")}}function fe(s,o){s&1&&(i(0,"div",61),a(1," Session name is required "),r())}function _e(s,o){if(s&1&&(i(0,"div",54)(1,"div",11)(2,"label",55),a(3,"Session Name "),i(4,"span",56),a(5,"*"),r()(),v(6,"input",57,1),b(8,ge,2,1,"div",58)(9,fe,2,0,"div",59),r()()),s&2){let e,t,n=d();l(6),h("is-invalid",((e=n.form.get("sessionName"))==null?null:e.invalid)&&((e=n.form.get("sessionName"))==null?null:e.touched)||!!n.sessionFormErrors.sessionName),l(2),u("ngIf",n.sessionFormErrors.sessionName),l(),u("ngIf",((t=n.form.get("sessionName"))==null?null:t.invalid)&&((t=n.form.get("sessionName"))==null?null:t.touched)&&!n.sessionFormErrors.sessionName)}}function be(s,o){if(s&1){let e=x();i(0,"button",62),f("click",function(){p(e);let n=d();return g(n.openTaskModal())}),i(1,"span",63),a(2,"add"),r()()}}function xe(s,o){s&1&&(i(0,"div",64)(1,"p",65),a(2,"No tasks added yet. Click the + button to create your first task."),r()())}function he(s,o){if(s&1){let e=x();i(0,"div",77)(1,"button",78),f("click",function(){p(e);let n=d().index,c=d(2);return g(c.openTaskModal(n))}),i(2,"span",79),a(3,"edit"),r()(),i(4,"button",80),f("click",function(){p(e);let n=d().index,c=d(2);return g(c.deleteTask(n))}),i(5,"span",79),a(6,"delete"),r()()()}}function ke(s,o){if(s&1&&(i(0,"div",84)(1,"span",85),a(2),r(),i(3,"span",86),a(4),r()()),s&2){let e,t,n=o.$implicit,c=d(4);l(2),w("\u2014 ",((e=n.get("subtaskName"))==null?null:e.value)||"Untitled"),l(2),S(c.formatDuration(((t=n.get("duration"))==null?null:t.value)||0))}}function ve(s,o){if(s&1&&(i(0,"div",81)(1,"h6",82),a(2,"Subtasks"),r(),b(3,ke,5,2,"div",83),r()),s&2){let e=d().index,t=d(2);l(3),u("ngForOf",t.getSubtasksControls(e))}}function Ce(s,o){if(s&1&&(i(0,"div",68)(1,"div",69)(2,"div",70)(3,"h5",71),a(4),r(),b(5,he,7,0,"div",72),r(),i(6,"div",73)(7,"span",74),a(8,"Task Duration"),r(),i(9,"strong",75),a(10),r()(),b(11,ve,4,1,"div",76),r()()),s&2){let e,t,n=o.$implicit,c=o.index,m=d(2);l(4),S((e=n.get("taskName"))==null?null:e.value),l(),u("ngIf",!m.isViewMode),l(5),S(m.formatDuration(m.taskGroupDuration(n))),l(),u("ngIf",((t=n.get("hasSubtasks"))==null?null:t.value)&&m.getSubtasksControls(c).length>0)}}function Se(s,o){if(s&1&&(i(0,"div")(1,"div",66),b(2,Ce,12,4,"div",67),r()()),s&2){let e=d();l(2),u("ngForOf",e.tasks.controls)}}function Me(s,o){if(s&1){let e=x();i(0,"div",87)(1,"button",88),a(2,"Save Session"),r(),i(3,"button",89),f("click",function(){p(e);let n=d();return g(n.cancel())}),a(4,"Cancel"),r()()}}function we(s,o){if(s&1&&(i(0,"div",60),a(1),r()),s&2){let e=d(2);l(),w(" ",e.taskModalErrors.taskName," ")}}function ye(s,o){s&1&&(i(0,"div",61),a(1," Task name is required "),r())}function Pe(s,o){if(s&1&&(i(0,"div",60),a(1),r()),s&2){let e=d(3);l(),w(" ",e.taskModalErrors.duration," ")}}function Oe(s,o){if(s&1&&(i(0,"div",101)(1,"label",112),a(2,"Duration "),i(3,"span",56),a(4,"*"),r()(),i(5,"div",20)(6,"div",21),v(7,"input",113),i(8,"label",114),a(9,"Hours"),r()(),i(10,"div",21),v(11,"input",115),i(12,"label",116),a(13,"Minutes"),r()(),i(14,"div",21),v(15,"input",117),i(16,"label",118),a(17,"Seconds"),r()()(),b(18,Pe,2,1,"div",58),r()),s&2){let e=d(2);l(18),u("ngIf",e.taskModalErrors.duration)}}function Ee(s,o){if(s&1&&(i(0,"div",60),a(1),r()),s&2){let e=d(3);l(),w(" ",e.taskModalErrors.subtasks," ")}}function Fe(s,o){if(s&1){let e=x();i(0,"div",97)(1,"div",123)(2,"div",124)(3,"div",125)(4,"strong",126),a(5),r(),i(6,"div",127),a(7),r()(),i(8,"div",128)(9,"button",78),f("click",function(){let n=p(e).index,c=d(3);return g(c.openSubtaskModal(n))}),i(10,"span",79),a(11,"edit"),r()(),i(12,"button",80),f("click",function(){let n=p(e).index,c=d(3);return g(c.removeSubtaskInModal(n))}),i(13,"span",79),a(14,"delete"),r()()()()()()}if(s&2){let e,t,n=o.$implicit,c=d(3);u("formGroup",c.controlAsGroup(n)),l(5),S(((e=n.get("subtaskName"))==null?null:e.value)||"Untitled Subtask"),l(2),S(c.formatDuration(((t=n.get("duration"))==null?null:t.value)||0))}}function Te(s,o){if(s&1){let e=x();i(0,"div")(1,"div",119)(2,"h6",120),a(3,"Subtasks"),r(),i(4,"button",62),f("click",function(){p(e);let n=d(2);return g(n.openSubtaskModal())}),i(5,"span",79),a(6,"add"),r()()(),b(7,Ee,2,1,"div",58)(8,Fe,15,3,"div",121),i(9,"div",122),a(10,"Total subtask duration: "),i(11,"span",75),a(12),r()()()}if(s&2){let e=d(2);l(7),u("ngIf",e.taskModalErrors.subtasks),l(),u("ngForOf",e.taskModalSubtasks.controls),l(4),S(e.formatDuration(e.taskModalTotalDuration))}}function Ne(s,o){if(s&1){let e=x();i(0,"div",90)(1,"div",91)(2,"div",92)(3,"div",93)(4,"h5",94),a(5),r(),i(6,"button",95),f("click",function(){p(e);let n=d();return g(n.closeTaskModal())}),r()(),i(7,"div",96)(8,"form",97)(9,"div",98),v(10,"input",99),i(11,"label",100),a(12,"Task Name "),i(13,"span",56),a(14,"*"),r()(),b(15,we,2,1,"div",58)(16,ye,2,0,"div",59),r(),i(17,"div",101)(18,"label",102),a(19,"Subtasks?"),r(),i(20,"div")(21,"div",103),v(22,"input",104),i(23,"label",105),a(24,"Yes"),r()(),i(25,"div",103),v(26,"input",106),i(27,"label",107),a(28,"No"),r()()()(),b(29,Oe,19,1,"div",108)(30,Te,13,3,"div",16),r()(),i(31,"div",109)(32,"button",110),f("click",function(){p(e);let n=d();return g(n.saveTaskModal())}),a(33,"Save Task"),r(),i(34,"button",111),f("click",function(){p(e);let n=d();return g(n.closeTaskModal())}),a(35,"Cancel"),r()()()()()}if(s&2){let e,t,n,c,m=d();P("display",m.taskModalOpen?"block":"none"),h("show",m.taskModalOpen),l(5),S(m.editingTaskIndex===null?"Add Task":"Edit Task"),l(3),u("formGroup",m.taskModalForm),l(2),h("is-invalid",((e=m.taskModalForm.get("taskName"))==null?null:e.invalid)&&((e=m.taskModalForm.get("taskName"))==null?null:e.touched)||!!m.taskModalErrors.taskName),l(5),u("ngIf",m.taskModalErrors.taskName),l(),u("ngIf",((t=m.taskModalForm.get("taskName"))==null?null:t.invalid)&&((t=m.taskModalForm.get("taskName"))==null?null:t.touched)&&!m.taskModalErrors.taskName),l(6),u("value",!0),l(4),u("value",!1),l(3),u("ngIf",!((n=m.taskModalForm.get("hasSubtasks"))!=null&&n.value)),l(),u("ngIf",(c=m.taskModalForm.get("hasSubtasks"))==null?null:c.value)}}function Ie(s,o){if(s&1){let e=x();i(0,"div",129),f("click",function(){p(e);let n=d();return g(n.closeTaskModal())}),r()}if(s&2){let e=d();h("show",e.taskModalOpen)}}function Ve(s,o){if(s&1&&(i(0,"div",60),a(1),r()),s&2){let e=d(2);l(),w(" ",e.subtaskModalErrors.subtaskName," ")}}function De(s,o){s&1&&(i(0,"div",61),a(1," Subtask name is required "),r())}function ze(s,o){if(s&1&&(i(0,"div",60),a(1),r()),s&2){let e=d(2);l(),w(" ",e.subtaskModalErrors.duration," ")}}function Ae(s,o){if(s&1){let e=x();i(0,"div",90)(1,"div",91)(2,"div",92)(3,"div",93)(4,"h5",130),a(5),r(),i(6,"button",95),f("click",function(){p(e);let n=d();return g(n.closeSubtaskModal())}),r()(),i(7,"div",96)(8,"form",97)(9,"div",98),v(10,"input",131),i(11,"label",132),a(12,"Subtask Name "),i(13,"span",56),a(14,"*"),r()(),b(15,Ve,2,1,"div",58)(16,De,2,0,"div",59),r(),i(17,"div",101)(18,"label",112),a(19,"Duration "),i(20,"span",56),a(21,"*"),r()(),i(22,"div",20)(23,"div",21),v(24,"input",133),i(25,"label",134),a(26,"Hours"),r()(),i(27,"div",21),v(28,"input",135),i(29,"label",136),a(30,"Minutes"),r()(),i(31,"div",21),v(32,"input",137),i(33,"label",138),a(34,"Seconds"),r()()(),b(35,ze,2,1,"div",58),r()()(),i(36,"div",109)(37,"button",110),f("click",function(){p(e);let n=d();return g(n.saveSubtaskModal())}),a(38,"Save"),r(),i(39,"button",111),f("click",function(){p(e);let n=d();return g(n.closeSubtaskModal())}),a(40,"Cancel"),r()()()()()}if(s&2){let e,t,n=d();P("display",n.subtaskModalOpen?"block":"none"),h("show",n.subtaskModalOpen),l(5),S(n.editingSubtaskIndex===null?"Add Subtask":"Edit Subtask"),l(3),u("formGroup",n.subtaskModalForm),l(2),h("is-invalid",((e=n.subtaskModalForm.get("subtaskName"))==null?null:e.invalid)&&((e=n.subtaskModalForm.get("subtaskName"))==null?null:e.touched)||!!n.subtaskModalErrors.subtaskName),l(5),u("ngIf",n.subtaskModalErrors.subtaskName),l(),u("ngIf",((t=n.subtaskModalForm.get("subtaskName"))==null?null:t.invalid)&&((t=n.subtaskModalForm.get("subtaskName"))==null?null:t.touched)&&!n.subtaskModalErrors.subtaskName),l(19),u("ngIf",n.subtaskModalErrors.duration)}}function Le(s,o){if(s&1){let e=x();i(0,"div",129),f("click",function(){p(e);let n=d();return g(n.closeSubtaskModal())}),r()}if(s&2){let e=d();h("show",e.subtaskModalOpen)}}function je(s,o){s&1&&(T(0),i(1,"p",146),a(2,"Are you sure you want to delete this session? This action cannot be undone."),r(),N())}function He(s,o){s&1&&(i(0,"p",147),a(1,"This session is synced or system-generated. Sign in to manage it."),r())}function Ge(s,o){if(s&1){let e=x();i(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",93)(4,"h5",142),a(5,"Delete Session?"),r(),i(6,"button",95),f("click",function(){p(e);let n=d();return g(n.cancelDeleteSession())}),r()(),i(7,"div",96),b(8,je,3,0,"ng-container",7)(9,He,2,0,"ng-template",null,2,V),r(),i(11,"div",143)(12,"button",144),f("click",function(){p(e);let n=d();return g(n.cancelDeleteSession())}),a(13,"Cancel"),r(),i(14,"button",145),f("click",function(){p(e);let n=d();return g(n.confirmDeleteSession())}),a(15,"Delete"),r()()()()()}if(s&2){let e=I(10),t=d();P("display",t.showDeleteSessionModal?"block":"none"),h("show",t.showDeleteSessionModal),l(8),u("ngIf",!t.deleteBlocked)("ngIfElse",e),l(6),h("disabled",t.deleteBlocked),u("disabled",t.deleteBlocked)}}function Re(s,o){if(s&1){let e=x();i(0,"div",148),f("click",function(){p(e);let n=d();return g(n.cancelDeleteSession())}),r()}if(s&2){let e=d();h("show",e.showDeleteSessionModal)}}function qe(s,o){if(s&1){let e=x();i(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",93)(4,"h5",142),a(5,"Delete Task?"),r(),i(6,"button",95),f("click",function(){p(e);let n=d();return g(n.cancelDeleteTask())}),r()(),i(7,"div",96)(8,"p",146),a(9,"Are you sure you want to delete this task? This action cannot be undone."),r()(),i(10,"div",143)(11,"button",144),f("click",function(){p(e);let n=d();return g(n.cancelDeleteTask())}),a(12,"Cancel"),r(),i(13,"button",149),f("click",function(){p(e);let n=d();return g(n.confirmDeleteTask())}),a(14,"Delete"),r()()()()()}if(s&2){let e=d();P("display",e.showDeleteTaskModal?"block":"none"),h("show",e.showDeleteTaskModal)}}function Be(s,o){if(s&1){let e=x();i(0,"div",148),f("click",function(){p(e);let n=d();return g(n.cancelDeleteTask())}),r()}if(s&2){let e=d();h("show",e.showDeleteTaskModal)}}function We(s,o){if(s&1){let e=x();i(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",93)(4,"h5",142),a(5,"Notice"),r(),i(6,"button",95),f("click",function(){p(e);let n=d();return g(n.dismissLocalStorageWarning())}),r()(),i(7,"div",96)(8,"p",85),a(9,"You are not logged in. This session will be saved on this device only and may be lost if browser cache or memory is cleared."),r(),i(10,"p",146),a(11,"To save your sessions to your profile and access them from any device, please sign in."),r()(),i(12,"div",143)(13,"button",144),f("click",function(){p(e);let n=d();return g(n.dismissLocalStorageWarning())}),a(14,"Continue as Guest"),r(),i(15,"button",150),f("click",function(){p(e);let n=d();return g(n.goToLogin())}),a(16,"Sign In"),r()()()()()}if(s&2){let e=d();P("display",e.showLocalStorageWarning?"block":"none"),h("show",e.showLocalStorageWarning)}}function $e(s,o){if(s&1){let e=x();i(0,"div",148),f("click",function(){p(e);let n=d();return g(n.dismissLocalStorageWarning())}),r()}if(s&2){let e=d();h("show",e.showLocalStorageWarning)}}function Ye(s,o){s&1&&(i(0,"p",85),a(1,"This is a system-generated session. When you edit it, a copy will be created and saved to your device only (not synced to your account)."),r())}function Qe(s,o){s&1&&(i(0,"p",85),a(1,"This is a system-generated session. When you edit it, a copy will be created and saved to your account."),r())}function Ue(s,o){if(s&1){let e=x();i(0,"div",139)(1,"div",140)(2,"div",141)(3,"div",93)(4,"h5",142),a(5,"Edit System-Generated Session"),r(),i(6,"button",95),f("click",function(){p(e);let n=d();return g(n.closePredefinedLocalEditModal())}),r()(),i(7,"div",96),b(8,Ye,2,0,"p",151)(9,Qe,2,0,"p",151),i(10,"p",146),a(11,"The original template will remain unchanged."),r()(),i(12,"div",143)(13,"button",144),f("click",function(){p(e);let n=d();return g(n.closePredefinedLocalEditModal())}),a(14,"Cancel"),r(),i(15,"button",150),f("click",function(){p(e);let n=d();return g(n.confirmPredefinedLocalEdit())}),a(16,"Continue Editing"),r()()()()()}if(s&2){let e=d();P("display",e.showPredefinedLocalEditModal?"block":"none"),h("show",e.showPredefinedLocalEditModal),l(8),u("ngIf",!e.isLoggedIn),l(),u("ngIf",e.isLoggedIn)}}function Je(s,o){if(s&1){let e=x();i(0,"div",148),f("click",function(){p(e);let n=d();return g(n.closePredefinedLocalEditModal())}),r()}if(s&2){let e=d();h("show",e.showPredefinedLocalEditModal)}}var ae=class s{constructor(o,e,t,n,c,m){this.sessionsService=o;this.fb=e;this.router=t;this.route=n;this.cdr=c;this.oauthService=m;this.form=this.fb.group({sessionName:["",[M.required,M.minLength(1)]],isTimed:[!0],totalDuration:[0],durationHours:[0],durationMinutes:[0],durationSeconds:[0],tasks:this.fb.array([])}),this.taskModalForm=this.fb.group({taskName:["",[M.required,M.minLength(1)]],hasSubtasks:[!1],taskDuration:[0],durationHours:[0],durationMinutes:[0],durationSeconds:[0],subtasks:this.fb.array([])}),this.subtaskModalForm=this.fb.group({subtaskName:["",[M.required,M.minLength(1)]],duration:[0],durationHours:[0],durationMinutes:[0],durationSeconds:[0]});let _=this.taskModalForm.get("taskDuration");_.setValidators([M.required,M.min(0)]),_.updateValueAndValidity({emitEvent:!1}),this.taskModalForm.get("hasSubtasks").valueChanges.subscribe(k=>{k?(_.disable({emitEvent:!1}),_.clearValidators(),_.updateValueAndValidity({emitEvent:!1})):(_.enable({emitEvent:!1}),_.setValidators([M.required,M.min(0)]),_.updateValueAndValidity({emitEvent:!1}))})}sessions=[];editingIndex=null;currentSession=null;isViewMode=!1;isEditMode=!1;form;taskModalOpen=!1;subtaskModalOpen=!1;editingTaskIndex=null;editingSubtaskIndex=null;showDeleteSessionModal=!1;showEditBlockedModal=!1;showDeleteTaskModal=!1;taskToDelete=null;reopenTaskModalAfterSubtask=!1;cloningPredefined=!1;clonedFromPredefinedNotice=!1;showPredefinedLocalEditModal=!1;localEditPendingNavigation=!1;taskModalForm;subtaskModalForm;subs=new D;loadedForEdit=!1;taskModalErrors={};subtaskModalErrors={};sessionFormErrors={};get deleteBlocked(){return this.isLoggedIn?!1:!!this.currentSession?.id}isLoggedIn=!1;showLocalStorageWarning=!1;isSaving=!1;sessionNameInput;ngOnInit(){this.isLoggedIn=this.oauthService.hasValidAccessToken();let o=this.router.getCurrentNavigation()?.extras.state;this.clonedFromPredefinedNotice=!!(o?.clonedFromPredefined||window.history.state&&window.history.state.clonedFromPredefined),this.subs.add(this.sessionsService.sessions$.subscribe(e=>{this.sessions=e,this.editingIndex!==null&&!this.loadedForEdit&&this.sessions[this.editingIndex]&&(this.loadForEdit(this.editingIndex),this.loadedForEdit=!0,this.isViewMode&&this.form.disable({emitEvent:!1}),this.handlePredefinedEditRedirect())})),this.subs.add(this.route.paramMap.subscribe(e=>{let t=this.route.snapshot.routeConfig?.path||"";this.isViewMode=t.includes("view"),this.isEditMode=t.includes("edit");let n=e.get("id");if(n!==null){let c=Number(n);isNaN(c)||(this.editingIndex=c,this.sessions[c]&&!this.loadedForEdit&&(this.loadForEdit(c),this.loadedForEdit=!0,this.isViewMode&&this.form.disable({emitEvent:!1}),this.handlePredefinedEditRedirect()))}})),this.sessionsService.refreshSessions()}ngOnDestroy(){this.subs.unsubscribe()}dismissLocalStorageWarning(){this.showLocalStorageWarning=!1}goToLogin(){this.showLocalStorageWarning=!1,this.router.navigate(["/login"])}get tasks(){return this.form.get("tasks")}addTask(o){let e=this.fb.array((o?.subtasks||[]).map(n=>this.fb.group({subtaskName:[n.subtaskName],duration:[n.duration]}))),t=this.fb.group({taskName:[o?.taskName||""],hasSubtasks:[o?.hasSubtasks??!1],taskDuration:[o?.taskDuration||0],subtasks:e});this.tasks.push(t)}getSubtasksControls(o){let e=this.tasks.at(o).get("subtasks");return e?e.controls:[]}openTaskModal(o){this.editingTaskIndex=typeof o=="number"?o:null;let e=this.taskModalForm,t=e.get("subtasks");for(;t.length;)t.removeAt(0);if(this.editingTaskIndex!==null){let n=this.tasks.at(this.editingTaskIndex).value,c=n.taskDuration||0,m=Math.floor(c/3600),_=Math.floor(c%3600/60),C=c%60;e.patchValue({taskName:n.taskName,hasSubtasks:!!n.hasSubtasks,taskDuration:n.taskDuration||0,durationHours:m,durationMinutes:_,durationSeconds:C}),(n.subtasks||[]).forEach(k=>t.push(this.fb.group({subtaskName:[k.subtaskName],duration:[k.duration]})))}else e.reset({taskName:"",hasSubtasks:!1,taskDuration:0,durationHours:0,durationMinutes:0,durationSeconds:0});this.taskModalOpen=!0,setTimeout(()=>{try{this.sessionNameInput?.nativeElement?.focus()}catch{}},0)}closeTaskModal(){this.taskModalOpen=!1,this.editingTaskIndex=null;let o=this.taskModalForm.get("subtasks");for(;o.length;)o.removeAt(0);this.taskModalErrors={}}saveTaskModal(){this.taskModalErrors={};let o=!!this.taskModalForm.get("hasSubtasks")?.value;if(o&&this.taskModalSubtasks.length===0){this.taskModalErrors.subtasks="Please add at least one subtask";return}if(!this.taskModalForm.get("taskName")?.value?.trim()){this.taskModalErrors.taskName="Task name is required";return}if(!o){let m=Number(this.taskModalForm.get("durationHours")?.value||0),_=Number(this.taskModalForm.get("durationMinutes")?.value||0),C=Number(this.taskModalForm.get("durationSeconds")?.value||0);if(m*3600+_*60+C===0){this.taskModalErrors.duration="Duration is required for tasks without subtasks";return}}for(let m=0;m<this.taskModalSubtasks.length;m++){let _=this.taskModalSubtasks.at(m),C=_.get("subtaskName")?.value,k=Number(_.get("duration")?.value||0);if(!C?.trim()){this.taskModalErrors[`subtask_${m}_name`]=`Subtask ${m+1}: Name is required`;return}if(k===0){this.taskModalErrors[`subtask_${m}_duration`]=`Subtask ${m+1}: Duration is required`;return}}if(this.taskModalForm.invalid)return;let t=this.taskModalForm.value,n=0;if(o)n=this.taskModalSubtasks.controls.reduce((m,_)=>m+Number(_.get("duration")?.value||0),0);else{let m=Number(t.durationHours)||0,_=Number(t.durationMinutes)||0,C=Number(t.durationSeconds)||0;n=m*3600+_*60+C}let c={taskName:t.taskName,hasSubtasks:o,taskDuration:n,subtasks:(t.subtasks||[]).map(m=>({subtaskName:m.subtaskName,duration:Number(m.duration)||0}))};if(this.editingTaskIndex===null)this.addTask(c);else{let m=this.tasks.at(this.editingTaskIndex);m.patchValue({taskName:c.taskName,hasSubtasks:c.hasSubtasks,taskDuration:c.taskDuration});let _=m.get("subtasks");for(;_.length;)_.removeAt(0);(c.subtasks||[]).forEach(C=>_.push(this.fb.group({subtaskName:[C.subtaskName],duration:[C.duration]})))}this.closeTaskModal()}get taskModalSubtasks(){return this.taskModalForm.get("subtasks")}openSubtaskModal(o){this.editingSubtaskIndex=typeof o=="number"?o:null;let e=this.taskModalSubtasks;if(this.editingSubtaskIndex!==null){let t=e.at(this.editingSubtaskIndex).value,n=t.duration||0,c=Math.floor(n/3600),m=Math.floor(n%3600/60),_=n%60;this.subtaskModalForm.patchValue({subtaskName:t.subtaskName,duration:t.duration,durationHours:c,durationMinutes:m,durationSeconds:_})}else this.subtaskModalForm.reset({subtaskName:"",duration:0,durationHours:0,durationMinutes:0,durationSeconds:0});this.reopenTaskModalAfterSubtask=this.taskModalOpen,this.taskModalOpen=!1,setTimeout(()=>{this.subtaskModalOpen=!0,this.cdr.detectChanges()},0)}closeSubtaskModal(){this.subtaskModalOpen=!1,this.editingSubtaskIndex=null,this.subtaskModalForm.reset({subtaskName:"",duration:0,durationHours:0,durationMinutes:0,durationSeconds:0}),this.subtaskModalErrors={},this.reopenTaskModalAfterSubtask&&setTimeout(()=>{this.taskModalOpen=!0,this.cdr.detectChanges()},0),this.reopenTaskModalAfterSubtask=!1}saveSubtaskModal(){if(this.subtaskModalErrors={},!this.subtaskModalForm.get("subtaskName")?.value?.trim()){this.subtaskModalErrors.subtaskName="Subtask name is required";return}let e=Number(this.subtaskModalForm.get("durationHours")?.value||0),t=Number(this.subtaskModalForm.get("durationMinutes")?.value||0),n=Number(this.subtaskModalForm.get("durationSeconds")?.value||0),c=e*3600+t*60+n;if(c===0){this.subtaskModalErrors.duration="Subtask duration is required";return}if(this.subtaskModalForm.invalid)return;let m=this.subtaskModalForm.value,_=this.taskModalSubtasks;this.editingSubtaskIndex===null?_.push(this.fb.group({subtaskName:[m.subtaskName],duration:[c]})):_.at(this.editingSubtaskIndex).patchValue({subtaskName:m.subtaskName,duration:c}),this.closeSubtaskModal()}viewTotalDurationSeconds(){return Number(this.form.get("totalDuration")?.value||0)}removeSubtaskInModal(o){this.taskModalSubtasks.removeAt(o)}get taskModalTotalDuration(){return this.taskModalSubtasks.controls.reduce((o,e)=>o+Number(e.get("duration")?.value||0),0)}get taskModalComputedDuration(){return!!this.taskModalForm.get("hasSubtasks")?.value?this.taskModalTotalDuration:Number(this.taskModalForm.get("taskDuration")?.value||0)}taskGroupDuration(o){if(!!o.get("hasSubtasks")?.value){let t=o.get("subtasks");return t?t.controls.reduce((n,c)=>n+Number(c.get("duration")?.value||0),0):0}return Number(o.get("taskDuration")?.value||0)}controlAsGroup(o){return o}formatDuration(o){let e=Math.floor(o/3600),t=Math.floor(o%3600/60),n=o%60;return`${e}h ${t}m ${n}s`}loadForEdit(o){let e=this.sessions[o];this.editingIndex=o,this.currentSession=e;let t=e.totalDuration||0,n=Math.floor(t/3600),c=Math.floor(t%3600/60),m=t%60;for(this.form.patchValue({sessionName:e.sessionName,isTimed:e.isTimed,totalDuration:e.totalDuration||0,durationHours:n,durationMinutes:c,durationSeconds:m});this.tasks.length;)this.tasks.removeAt(0);e.tasks.forEach(_=>this.addTask(_))}async save(){if(this.sessionFormErrors={},this.isSaving=!0,!this.form.get("sessionName")?.value?.trim()){this.sessionFormErrors.sessionName="Session name is required",this.isSaving=!1;return}let e=this.form.value,t=Number(e.durationHours)||0,n=Number(e.durationMinutes)||0,c=Number(e.durationSeconds)||0,m=t*3600+n*60+c,C={id:(this.editingIndex!==null&&this.editingIndex<this.sessions.length?this.sessions[this.editingIndex]:null)?.id,sessionName:e.sessionName,isTimed:!!e.isTimed,totalDuration:m>0?m:Number(e.totalDuration)||0,tasks:(e.tasks||[]).map(k=>({taskName:k.taskName,hasSubtasks:!!k.hasSubtasks,taskDuration:Number(k.taskDuration)||0,subtasks:(k.subtasks||[]).map(F=>({subtaskName:F.subtaskName,duration:Number(F.duration)||0}))}))};try{await this.sessionsService.saveSession(C,this.editingIndex??void 0,this.currentSession||void 0),await this.sessionsService.refreshSessions(),this.router.navigate(["/sessions"])}catch(k){let F=this.resolveApiErrorMessage(k);this.sessionFormErrors=E(O({},this.sessionFormErrors),{api:F}),setTimeout(()=>{try{document.getElementById("session-api-error")?.scrollIntoView({behavior:"smooth",block:"center"})}catch{}},0);try{this.cdr.detectChanges()}catch{}console.error("Save failed:",k)}finally{this.isSaving=!1}}cancel(){this.router.navigate(["/sessions"])}goToEdit(){this.editingIndex!==null&&this.router.navigate(["/sessions",this.editingIndex,"edit"])}deleteCurrent(){this.editingIndex!==null&&(this.taskModalOpen=!1,this.subtaskModalOpen=!1,setTimeout(()=>{this.showDeleteSessionModal=!0,this.cdr.detectChanges()},0))}async confirmDeleteSession(){if(this.editingIndex!==null)try{await this.sessionsService.deleteSession(this.editingIndex),this.showDeleteSessionModal=!1,this.router.navigate(["/sessions"])}catch(o){this.showDeleteSessionModal=!1;let e=o?.message||"Server issue: unable to delete right now. Please try again later.";this.sessionFormErrors=E(O({},this.sessionFormErrors),{api:e}),setTimeout(()=>{try{document.getElementById("session-api-error")?.scrollIntoView({behavior:"smooth",block:"center"})}catch{}},0);try{this.cdr.detectChanges()}catch{}console.error("Delete failed:",o)}}cancelDeleteSession(){this.showDeleteSessionModal=!1}onEditClick(){if(this.currentSession?.isPredefined){this.showPredefinedLocalEditModal=!0;return}this.goToEdit()}confirmPredefinedLocalEdit(){this.showPredefinedLocalEditModal=!1,this.createLocalCopyAndNavigate()}closePredefinedLocalEditModal(){this.showPredefinedLocalEditModal=!1}deleteTask(o){this.taskToDelete=o,this.taskModalOpen=!1,this.subtaskModalOpen=!1,setTimeout(()=>{this.showDeleteTaskModal=!0,this.cdr.detectChanges()},0)}confirmDeleteTask(){this.taskToDelete!==null&&(this.tasks.removeAt(this.taskToDelete),this.taskToDelete=null),this.showDeleteTaskModal=!1}cancelDeleteTask(){this.showDeleteTaskModal=!1,this.taskToDelete=null}playSession(){this.editingIndex!==null&&this.router.navigate(["/sessions",this.editingIndex,"timer"])}async handlePredefinedEditRedirect(){!this.isEditMode||this.isViewMode||this.clonedFromPredefinedNotice||!this.isLoggedIn||!this.currentSession?.isPredefined||this.localEditPendingNavigation||(this.showPredefinedLocalEditModal=!0)}buildPredefinedClone(){if(!this.currentSession)return null;let o=JSON.parse(JSON.stringify(this.currentSession));return o.id=void 0,o.isPredefined=!1,o.sessionName=o.sessionName?`${o.sessionName} (copy)`:"Session (copy)",o.tasks=(o.tasks||[]).map(e=>E(O({},e),{id:void 0,subtasks:(e.subtasks||[]).map(t=>E(O({},t),{id:void 0}))})),o}async createLocalCopyAndNavigate(){if(this.cloningPredefined)return;let o=this.buildPredefinedClone();if(o){this.cloningPredefined=!0,this.localEditPendingNavigation=!0;try{let e=await this.sessionsService.saveSession(o);await this.sessionsService.refreshSessions();let t=this.sessionsService.getSnapshot(),n=e.id?t.findIndex(c=>c.id===e.id):t.findIndex(c=>!c.id&&c.sessionName===o.sessionName);n<0&&(n=t.length?t.length-1:0),this.router.navigate(["/sessions",n,"edit"],{state:{clonedFromPredefined:!0}})}catch(e){let t=this.resolveApiErrorMessage(e);this.sessionFormErrors=E(O({},this.sessionFormErrors),{api:t}),setTimeout(()=>{try{document.getElementById("session-api-error")?.scrollIntoView({behavior:"smooth",block:"center"})}catch{}},0)}finally{this.cloningPredefined=!1,this.localEditPendingNavigation=!1}}}resolveApiErrorMessage(o){let e=o?.error;if(typeof e=="string")try{let t=JSON.parse(e);if(t?.message)return t.message;if(t?.error_description)return t.error_description;if(t?.error)return t.error}catch{return e}if(e?.message)return e.message;if(e?.error?.message)return e.error.message;if(e?.detail)return e.detail;if(e?.title)return e.title;if(Array.isArray(e?.errors)&&e.errors.length)return e.errors.join("; ");if(e?.errors&&typeof e.errors=="object"){let t=Object.values(e.errors).flat().filter(Boolean).join("; ");if(t)return t}return o?.message?o.message:o?.status?`Request failed (${o.status})`:"Failed to save session. Please try again."}static \u0275fac=function(e){return new(e||s)(y(re),y(ie),y(W),y(B),y(H),y($))};static \u0275cmp=z({type:s,selectors:[["app-session-form"]],viewQuery:function(e,t){if(e&1&&A(le,5),e&2){let n;L(n=j())&&(t.sessionNameInput=n.first)}},decls:48,vars:22,consts:[["editHeader",""],["sessionNameInput",""],["predefinedBlockedMsgView",""],[1,"session-form"],[1,"container-lg","py-4"],["id","session-api-error","class","alert alert-danger mb-4","role","alert","aria-live","assertive",4,"ngIf"],["class","alert alert-info mb-4","role","status",4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"ngSubmit","formGroup"],["class","form-card mb-4",4,"ngIf"],[1,"form-card"],[1,"form-section"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[2,"font-size","1.15rem","font-weight","700","color","#0f172a","margin","0"],["type","button","class","add-task-circle","style","display: inline-flex; align-items: center; justify-content: center;",3,"click",4,"ngIf"],["class","text-center text-muted py-5",4,"ngIf"],[4,"ngIf"],[1,"form-section","mt-4","pt-4","border-top"],[1,"form-label","fw-bold","mb-3"],[1,"small","text-muted"],[1,"d-flex","gap-2","flex-nowrap"],[1,"form-floating",2,"flex","1"],["type","number","id","durationHours","formControlName","durationHours","placeholder","Hours",1,"form-control"],["for","durationHours"],["type","number","id","durationMinutes","formControlName","durationMinutes","placeholder","Minutes",1,"form-control"],["for","durationMinutes"],["type","number","id","durationSeconds","formControlName","durationSeconds","placeholder","Seconds",1,"form-control"],["for","durationSeconds"],["class","mt-5 d-flex gap-3 w-100",4,"ngIf"],["class","modal fade","tabindex","-1",3,"show","display",4,"ngIf"],["class","modal-backdrop fade",3,"show","click",4,"ngIf"],["class","modal fade","tabindex","-1","style","z-index:200000;",3,"show","display",4,"ngIf"],["class","modal-backdrop fade","style","z-index:199999;",3,"show","click",4,"ngIf"],["id","session-api-error","role","alert","aria-live","assertive",1,"alert","alert-danger","mb-4"],["role","status",1,"alert","alert-info","mb-4"],[1,"d-flex","justify-content-center","mb-4","summary-actions","gap-3"],["type","button","title","Edit",1,"btn","btn-link","p-2","text-secondary",3,"click"],[1,"material-icons",2,"font-size","26px"],["type","button","title","Play",1,"btn","btn-link","p-2","text-primary",3,"click"],[1,"material-icons",2,"font-size","30px"],["type","button","title","Delete",1,"btn","btn-link","p-2","text-danger",3,"click"],[1,"view-summary-card","mb-4","d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center","gap-3"],[1,"material-icons","text-primary",2,"font-size","30px"],[1,"d-flex","flex-column","gap-1"],[1,"mb-0",2,"font-size","1.3rem","font-weight","700"],["class","text-muted fw-semibold","style","font-size: 0.9rem;",4,"ngIf"],[1,"d-flex","align-items-center","gap-2"],[1,"material-icons","text-timer",2,"font-size","22px"],[1,"fw-bold"],[1,"text-muted","fw-semibold",2,"font-size","0.9rem"],[1,"mb-4"],[1,"mb-1",2,"font-size","clamp(1.5rem, 3vw, 2rem)","font-weight","700","color","#0f172a"],[1,"text-muted","mb-0"],[1,"form-card","mb-4"],["for","sessionName",1,"form-label","fw-bold","mb-2"],[1,"text-danger"],["id","sessionName","formControlName","sessionName","placeholder","e.g., Constitutional Law Study",1,"form-control"],["class","invalid-feedback d-block",4,"ngIf"],["class","invalid-feedback",4,"ngIf"],[1,"invalid-feedback","d-block"],[1,"invalid-feedback"],["type","button",1,"add-task-circle",2,"display","inline-flex","align-items","center","justify-content","center",3,"click"],[1,"material-icons",2,"font-size","20px"],[1,"text-center","text-muted","py-5"],[1,"mb-0",2,"font-size","0.95rem"],[1,"row","g-3"],["class","col-12 col-md-6 col-lg-4",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","col-lg-4"],[1,"task-card","h-100"],[1,"d-flex","justify-content-between","align-items-start","mb-3"],[1,"mb-0",2,"font-size","1.05rem","font-weight","700","color","#0f172a"],["class","d-flex gap-1",4,"ngIf"],[1,"d-flex","justify-content-between","mb-3"],[1,"text-muted",2,"font-size","0.9rem","font-weight","600"],[2,"color","#0b4bb4","font-weight","700"],["class","mt-3 pt-3 border-top",4,"ngIf"],[1,"d-flex","gap-1"],["type","button",1,"btn","btn-sm","btn-link","text-secondary","p-1",3,"click"],[1,"material-icons",2,"font-size","18px"],["type","button",1,"btn","btn-sm","btn-link","text-danger","p-1",3,"click"],[1,"mt-3","pt-3","border-top"],[1,"mb-2",2,"font-size","0.9rem","font-weight","700","color","#64748b","text-transform","uppercase","letter-spacing","0.5px"],["class","d-flex justify-content-between mb-2 ps-3","style","font-size: 0.9rem;",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","mb-2","ps-3",2,"font-size","0.9rem"],[2,"color","#475569"],[2,"color","#0b4bb4","font-weight","600"],[1,"mt-5","d-flex","gap-3","w-100"],["type","submit",1,"btn","btn-primary",2,"padding","0.75rem 1.5rem","font-weight","700","border-radius","10px","flex","1"],["type","button",1,"btn","btn-outline-secondary",2,"padding","0.75rem 1.5rem","font-weight","700","border-radius","10px","flex","1",3,"click"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","modal-card"],[1,"modal-header","border-0","pb-2"],[1,"modal-title",2,"font-weight","700","font-size","1.2rem","color","#0f172a"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","pt-2"],[3,"formGroup"],[1,"form-floating","mb-3"],["id","taskName","formControlName","taskName","placeholder","e.g., Constitutional Amendments",1,"form-control"],["for","taskName"],[1,"mb-3"],[1,"form-label","fw-bold"],[1,"form-check","form-check-inline"],["type","radio","formControlName","hasSubtasks","id","hasSubYes",1,"form-check-input",3,"value"],["for","hasSubYes",1,"form-check-label"],["type","radio","formControlName","hasSubtasks","id","hasSubNo",1,"form-check-input",3,"value"],["for","hasSubNo",1,"form-check-label"],["class","mb-3",4,"ngIf"],[1,"modal-footer","d-flex","gap-3","border-0"],[1,"btn","btn-primary","flex-grow-1",2,"padding","0.6rem 1.2rem","font-weight","700","border-radius","10px",3,"click"],[1,"btn","btn-outline-secondary","flex-grow-1",2,"padding","0.6rem 1.2rem","font-weight","700","border-radius","10px",3,"click"],[1,"form-label","fw-bold","mb-2"],["type","number","id","taskDurationHours","formControlName","durationHours","placeholder","Hours","min","0",1,"form-control"],["for","taskDurationHours"],["type","number","id","taskDurationMinutes","formControlName","durationMinutes","placeholder","Minutes","min","0","max","59",1,"form-control"],["for","taskDurationMinutes"],["type","number","id","taskDurationSeconds","formControlName","durationSeconds","placeholder","Seconds","min","0","max","59",1,"form-control"],["for","taskDurationSeconds"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"mb-0",2,"font-weight","700","color","#0f172a"],[3,"formGroup",4,"ngFor","ngForOf"],[1,"small","text-muted","mt-3","pt-2","border-top",2,"font-size","0.85rem","font-weight","600"],[1,"task-card","mb-2","p-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"flex-grow-1"],[2,"font-size","0.95rem","color","#0f172a"],[1,"small","text-muted","mt-1",2,"font-size","0.85rem"],[1,"d-flex","align-items-center","gap-1"],[1,"modal-backdrop","fade",3,"click"],[1,"modal-title",2,"font-weight","700","font-size","1.1rem","color","#0f172a"],["id","subtaskName","formControlName","subtaskName","placeholder","e.g., Article 1-5",1,"form-control"],["for","subtaskName"],["type","number","id","subtaskDurationHours","formControlName","durationHours","placeholder","Hours","min","0",1,"form-control"],["for","subtaskDurationHours"],["type","number","id","subtaskDurationMinutes","formControlName","durationMinutes","placeholder","Minutes","min","0","max","59",1,"form-control"],["for","subtaskDurationMinutes"],["type","number","id","subtaskDurationSeconds","formControlName","durationSeconds","placeholder","Seconds","min","0","max","59",1,"form-control"],["for","subtaskDurationSeconds"],["tabindex","-1",1,"modal","fade",2,"z-index","200000"],["role","dialog","aria-modal","true",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","modal-card",2,"z-index","200001"],[1,"modal-title",2,"font-weight","700","color","#0f172a"],[1,"modal-footer","border-0","d-flex","gap-3"],["type","button",1,"btn","btn-outline-secondary","flex-grow-1",2,"padding","0.6rem 1.2rem","font-weight","700","border-radius","10px",3,"click"],["type","button",1,"btn","btn-danger","flex-grow-1",2,"padding","0.6rem 1.2rem","font-weight","700","border-radius","10px",3,"click","disabled"],[1,"mb-0",2,"color","#475569"],[1,"mb-0","text-danger","fw-semibold"],[1,"modal-backdrop","fade",2,"z-index","199999",3,"click"],["type","button",1,"btn","btn-danger","flex-grow-1",2,"padding","0.6rem 1.2rem","font-weight","700","border-radius","10px",3,"click"],["type","button",1,"btn","btn-primary","flex-grow-1",2,"padding","0.6rem 1.2rem","font-weight","700","border-radius","10px",3,"click"],["style","color: #475569;",4,"ngIf"]],template:function(e,t){if(e&1){let n=x();i(0,"div",3)(1,"div",4),b(2,de,4,1,"div",5)(3,ce,2,0,"div",6)(4,ue,24,3,"ng-container",7)(5,pe,5,1,"ng-template",null,0,V),i(7,"form",8),f("ngSubmit",function(){return p(n),g(t.save())}),b(8,_e,10,4,"div",9),i(9,"div",10)(10,"div",11)(11,"div",12)(12,"h4",13),a(13,"Tasks in Session"),r(),b(14,be,3,0,"button",14),r(),b(15,xe,3,0,"div",15)(16,Se,3,1,"div",16),r()(),i(17,"div",17)(18,"label",18),a(19,"Session Duration "),i(20,"span",19),a(21,"(optional)"),r()(),i(22,"div",20)(23,"div",21),v(24,"input",22),i(25,"label",23),a(26,"Hours"),r()(),i(27,"div",21),v(28,"input",24),i(29,"label",25),a(30,"Minutes"),r()(),i(31,"div",21),v(32,"input",26),i(33,"label",27),a(34,"Seconds"),r()()()(),b(35,Me,5,0,"div",28),r()(),b(36,Ne,36,14,"div",29)(37,Ie,1,2,"div",30)(38,Ae,41,11,"div",29)(39,Le,1,2,"div",30)(40,Ge,16,9,"div",31)(41,Re,1,2,"div",32)(42,qe,15,4,"div",31)(43,Be,1,2,"div",32)(44,We,17,4,"div",31)(45,$e,1,2,"div",32)(46,Ue,17,6,"div",31)(47,Je,1,2,"div",32),r()}if(e&2){let n=I(6);l(2),u("ngIf",t.sessionFormErrors.api),l(),u("ngIf",!t.isSaving&&t.isLoggedIn&&t.isEditMode&&(t.currentSession==null?null:t.currentSession.isPredefined)),l(),u("ngIf",t.isViewMode)("ngIfElse",n),l(3),u("formGroup",t.form),l(),u("ngIf",!t.isViewMode),l(6),u("ngIf",!t.isViewMode),l(),u("ngIf",!t.isViewMode&&t.tasks.controls.length===0),l(),u("ngIf",t.tasks.controls.length>0),l(19),u("ngIf",!t.isViewMode),l(),u("ngIf",t.taskModalOpen),l(),u("ngIf",t.taskModalOpen),l(),u("ngIf",t.subtaskModalOpen),l(),u("ngIf",t.subtaskModalOpen),l(),u("ngIf",t.showDeleteSessionModal),l(),u("ngIf",t.showDeleteSessionModal),l(),u("ngIf",t.showDeleteTaskModal),l(),u("ngIf",t.showDeleteTaskModal),l(),u("ngIf",t.showLocalStorageWarning),l(),u("ngIf",t.showLocalStorageWarning),l(),u("ngIf",t.showPredefinedLocalEditModal),l(),u("ngIf",t.showPredefinedLocalEditModal)}},dependencies:[q,G,R,oe,J,Y,K,X,Q,U,ne,te,se,ee,Z],styles:[".sessions-page[_ngcontent-%COMP%]{padding:3rem 1rem 6rem;background:linear-gradient(180deg,#fff,#f8fbff,#eef2ff);color:#0f172a;min-height:100vh}.sessions-page[_ngcontent-%COMP%]   .actions-bar[_ngcontent-%COMP%]{flex-wrap:nowrap}.sessions-page[_ngcontent-%COMP%]   .actions-bar[_ngcontent-%COMP%]   .search-holder[_ngcontent-%COMP%]{min-width:0}.sessions-page[_ngcontent-%COMP%]   .search-full[_ngcontent-%COMP%]{display:flex;align-items:center;background:#fff;border-radius:12px;padding:10px 14px;border:1px solid #e2e8f0;box-shadow:0 2px 8px #0f172a0f;transition:all .18s ease}.sessions-page[_ngcontent-%COMP%]   .search-full[_ngcontent-%COMP%]:focus-within{border-color:#0b4bb4;box-shadow:0 4px 12px #0b4bb41f}.sessions-page[_ngcontent-%COMP%]   .search-icon[_ngcontent-%COMP%]{font-size:20px;margin-right:10px;color:#64748b}.sessions-page[_ngcontent-%COMP%]   .search-full[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;box-shadow:none;padding:6px 0;background:transparent;color:#0f172a;font-weight:500}.sessions-page[_ngcontent-%COMP%]   .search-full[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:18px;border:1px solid rgba(16,24,40,.06);box-shadow:0 10px 24px #0f172a14;display:flex;flex-direction:column;min-height:120px;position:relative;transition:transform .18s ease,box-shadow .18s ease,border-color .18s ease,background-color .18s ease}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 14px 32px #0b4bb426;border-color:#cbd5e1}.sessions-page[_ngcontent-%COMP%]   .card-inner[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.sessions-page[_ngcontent-%COMP%]   .session-title-wrap[_ngcontent-%COMP%]{min-width:0}.sessions-page[_ngcontent-%COMP%]   .session-title-block[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:6px;align-items:center;min-width:0}.sessions-page[_ngcontent-%COMP%]   .session-title-main[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#0f172a;letter-spacing:.5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}.sessions-page[_ngcontent-%COMP%]   .session-title-suffix[_ngcontent-%COMP%]{font-size:.8rem;color:#475569;font-weight:700;line-height:1.2;white-space:nowrap}.sessions-page[_ngcontent-%COMP%]   .duration[_ngcontent-%COMP%]{display:flex;align-items:center;color:#475569;font-weight:600;font-size:.95rem}.sessions-page[_ngcontent-%COMP%]   .duration-text[_ngcontent-%COMP%]{font-weight:600}.sessions-page[_ngcontent-%COMP%]   .text-timer[_ngcontent-%COMP%]{color:#0b4bb4;font-weight:700}.sessions-page[_ngcontent-%COMP%]   .subtle-text[_ngcontent-%COMP%]{color:#475569;font-weight:600}.sessions-page[_ngcontent-%COMP%]   .meta-row[_ngcontent-%COMP%]{color:#64748b;font-size:.93rem}.sessions-page[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:12px;border:none;background:linear-gradient(135deg,#0b4bb4,#0856d6);display:flex;align-items:center;justify-content:center;padding:0;color:#fff;box-shadow:0 8px 20px #0b4bb43d;transition:transform .18s ease,box-shadow .18s ease}.sessions-page[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 28px #0b4bb452}.sessions-page[_ngcontent-%COMP%]   .fab[_ngcontent-%COMP%]{position:fixed;right:20px;bottom:20px;width:64px;height:64px;border-radius:16px;background:linear-gradient(135deg,#0b4bb4,#0856d6);border:none;font-size:28px;color:#fff;box-shadow:0 12px 28px #0b4bb447;display:flex;align-items:center;justify-content:center;transition:all .18s ease;cursor:pointer}.sessions-page[_ngcontent-%COMP%]   .fab[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 16px 36px #0b4bb45c}@media(min-width:768px){.sessions-page[_ngcontent-%COMP%]   .fab[_ngcontent-%COMP%]{display:none}}.sessions-page[_ngcontent-%COMP%]   .form-wrapper[_ngcontent-%COMP%]{padding-top:12px}.sessions-page[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:24px;box-shadow:0 10px 24px #0f172a14;border:1px solid rgba(16,24,40,.06)}.sessions-page[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{margin-bottom:24px}.sessions-page[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.sessions-page[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{font-size:clamp(1.3rem,2.5vw,1.5rem);padding:12px 0;border-radius:8px;color:#0f172a;font-weight:700}.sessions-page[_ngcontent-%COMP%]   .modal-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:20px;width:min(720px,96%);box-shadow:0 18px 46px #0f172a33;border:1px solid rgba(16,24,40,.06)}.sessions-page[_ngcontent-%COMP%]   .modal-card.small[_ngcontent-%COMP%]{width:min(420px,92%)}.sessions-page[_ngcontent-%COMP%]   .modal-card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .sessions-page[_ngcontent-%COMP%]   .modal-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-bottom:12px;color:#0f172a;font-weight:700}.sessions-page[_ngcontent-%COMP%]   .subtask-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0}.sessions-page[_ngcontent-%COMP%]   .sub-left[_ngcontent-%COMP%]{color:#1e293b;font-weight:600}.sessions-page[_ngcontent-%COMP%]   .sub-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.sessions-page[_ngcontent-%COMP%]   .tasks-section[_ngcontent-%COMP%]   .add-task-circle[_ngcontent-%COMP%]{width:48px!important;height:48px!important;min-width:48px!important;min-height:48px!important;border-radius:50%!important;background:linear-gradient(135deg,#0b4bb4,#0856d6)!important;color:#fff!important;border:none!important;display:flex!important;align-items:center!important;justify-content:center!important;padding:0!important;font-size:20px;transition:all .18s ease;box-shadow:0 8px 20px #0b4bb43d;cursor:pointer}.sessions-page[_ngcontent-%COMP%]   .tasks-section[_ngcontent-%COMP%]   .add-task-circle[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 12px 28px #0b4bb452}.sessions-page[_ngcontent-%COMP%]   .tasks-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.sessions-page[_ngcontent-%COMP%]   .session-form[_ngcontent-%COMP%]   .d-flex.gap-3[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]{min-width:0}@media(max-width:767.98px){.sessions-page[_ngcontent-%COMP%]{padding:2rem 1rem 6rem}.sessions-page[_ngcontent-%COMP%]   .session-title[_ngcontent-%COMP%]{font-size:1.05rem}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]{padding:16px;min-height:90px}.sessions-page[_ngcontent-%COMP%]   .session-form[_ngcontent-%COMP%]   .d-flex.gap-3[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]{flex:1 1 auto;min-width:0}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .card-inner[_ngcontent-%COMP%]{gap:8px}.sessions-page[_ngcontent-%COMP%]   .search-full[_ngcontent-%COMP%]{padding:10px 12px}.sessions-page[_ngcontent-%COMP%]   .fab[_ngcontent-%COMP%]{right:16px;bottom:16px}}@media(max-width:575.98px){.sessions-page[_ngcontent-%COMP%]{padding:1.5rem .75rem 6rem}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .icon-btn[_ngcontent-%COMP%]{display:none}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .card-inner[_ngcontent-%COMP%]{align-items:center;text-align:center;gap:10px}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .card-inner[_ngcontent-%COMP%] > .d-flex[_ngcontent-%COMP%]{justify-content:center}.sessions-page[_ngcontent-%COMP%]   .session-title-block[_ngcontent-%COMP%]{flex-direction:column;gap:2px;align-items:center;text-align:center}.sessions-page[_ngcontent-%COMP%]   .session-title-main[_ngcontent-%COMP%]{white-space:normal}.sessions-page[_ngcontent-%COMP%]   .session-title-suffix[_ngcontent-%COMP%]{font-size:.75rem;color:#64748b}.sessions-page[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .duration[_ngcontent-%COMP%]{justify-content:center;gap:8px}}.summary-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transition:all .18s ease;color:#0b4bb4;font-weight:600}.summary-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);color:#0856d6}.view-summary-card[_ngcontent-%COMP%]{background:#fff;border:1px solid rgba(16,24,40,.06);border-radius:14px;padding:20px 24px;box-shadow:0 10px 24px #0f172a14;transition:all .18s ease}.view-summary-card[_ngcontent-%COMP%]:hover{box-shadow:0 14px 32px #0b4bb41f;border-color:#cbd5e1}.task-card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:18px 20px;margin-bottom:12px;border:1px solid rgba(16,24,40,.06);box-shadow:0 10px 24px #0f172a14;transition:all .18s ease}.task-card[_ngcontent-%COMP%]:hover{box-shadow:0 14px 32px #0b4bb41f;border-color:#cbd5e1}.task-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.task-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.task-title[_ngcontent-%COMP%]{font-weight:700;color:#0f172a;font-size:1.05rem}.task-meta[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;font-weight:500}.task-ops[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0 6px}.subtask-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;color:#334155;padding:6px 0}.sub-dur[_ngcontent-%COMP%]{color:#2563eb;font-weight:600}.session-timer-page[_ngcontent-%COMP%]{max-width:720px;margin:0 auto}.timer-card[_ngcontent-%COMP%]{background:#e8e4f0;border-radius:20px;padding:24px;box-shadow:0 12px 28px #0000001a}.session-timer-card[_ngcontent-%COMP%]{background:#e8e4f0}.timer-header[_ngcontent-%COMP%]   .timer-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1f1f1f}.timer-display[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;text-align:center;letter-spacing:2px;transition:color .3s ease}@keyframes _ngcontent-%COMP%_shake{0%,to{transform:translate(0)}10%,30%,50%,70%,90%{transform:translate(-5px)}20%,40%,60%,80%{transform:translate(5px)}}.timer-negative[_ngcontent-%COMP%]{color:#dc3545!important;animation:_ngcontent-%COMP%_shake .5s ease-in-out infinite}.session-timer-display[_ngcontent-%COMP%]{color:#1c6fda}.session-timer-page[_ngcontent-%COMP%]{padding:2rem 1rem 4rem;background:linear-gradient(180deg,#fff,#f8fbff,#eef2ff);min-height:100vh}.timer-card[_ngcontent-%COMP%]{background:#fff;border:1px solid rgba(16,24,40,.06);border-radius:14px;padding:24px;box-shadow:0 10px 24px #0f172a14;transition:all .18s ease}.timer-card[_ngcontent-%COMP%]:hover{box-shadow:0 14px 32px #0b4bb41f;border-color:#cbd5e1}.session-timer-card[_ngcontent-%COMP%]{margin-bottom:20px}.timer-header[_ngcontent-%COMP%]{margin-bottom:16px}.timer-title[_ngcontent-%COMP%]{font-size:clamp(1.3rem,2vw,1.5rem);font-weight:700;color:#0f172a;letter-spacing:.5px}.timer-display[_ngcontent-%COMP%]{font-size:clamp(2.5rem,6vw,4rem);font-weight:700;color:#0b4bb4;text-align:center;font-family:Courier New,monospace;letter-spacing:2px;line-height:1.2}.timer-display.timer-negative[_ngcontent-%COMP%]{color:#dc2626}.session-timer-display[_ngcontent-%COMP%]{font-size:clamp(3rem,10vw,5rem);margin:24px 0}.session-only[_ngcontent-%COMP%]{padding:40px 24px!important;min-height:320px;display:flex;flex-direction:column;justify-content:center;align-items:center}.session-only-timer[_ngcontent-%COMP%]{font-size:clamp(4rem,12vw,6rem)!important;letter-spacing:4px;margin-top:32px;margin-bottom:32px}.task-selection-card[_ngcontent-%COMP%]{background:#fff;border:1px solid rgba(16,24,40,.06);padding:24px}.task-selection-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;text-align:center;color:#0f172a;letter-spacing:.5px}.task-timer-display[_ngcontent-%COMP%]{color:#0b4bb4;font-size:clamp(2.5rem,5vw,3.5rem)!important;margin-top:16px;margin-bottom:16px}.task-select-card[_ngcontent-%COMP%]{background:#fff;border:1px solid rgba(16,24,40,.06);border-radius:12px;padding:16px;cursor:pointer;transition:all .18s ease;box-shadow:0 4px 12px #0f172a14}.task-select-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #0b4bb41f;border-color:#cbd5e1}.task-select-card.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0b4bb4,#0856d6);box-shadow:0 8px 20px #0b4bb447;border-color:#0b4bb4}.task-select-card.selected[_ngcontent-%COMP%]   .task-name[_ngcontent-%COMP%], .task-select-card.selected[_ngcontent-%COMP%]   .task-duration-display[_ngcontent-%COMP%]{color:#fff}.task-select-card[_ngcontent-%COMP%]   .task-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#0b4bb4;margin-bottom:8px}.task-select-card[_ngcontent-%COMP%]   .task-duration-display[_ngcontent-%COMP%]{font-size:.9rem;color:#64748b;font-weight:600}.subtask-info[_ngcontent-%COMP%]{margin-top:20px;padding:16px;background:#f0f4ff;border-radius:12px;border:1px solid rgba(11,75,180,.1)}.subtask-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;margin-bottom:16px}.subtask-column[_ngcontent-%COMP%]{flex:1;text-align:center}.subtask-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:700;color:#64748b;margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px}.subtask-name[_ngcontent-%COMP%]{font-size:1.05rem;font-weight:700;color:#0f172a;word-break:break-word;margin-bottom:4px}.subtask-duration[_ngcontent-%COMP%]{font-size:.85rem;color:#64748b;font-weight:600}.subtask-timer-display[_ngcontent-%COMP%]{color:#0b4bb4!important;font-size:3.2rem!important;margin-top:16px}.task-duration-info[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:8px;padding:12px 16px;background:#f0f4ff;border-radius:10px;border:1px solid rgba(11,75,180,.1)}.task-duration-label[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600;color:#64748b}.task-duration-value[_ngcontent-%COMP%]{font-size:.95rem;font-weight:700;color:#0b4bb4}@media(max-width:768px){.session-timer-page[_ngcontent-%COMP%]{padding:1.5rem 1rem 4rem}.timer-card[_ngcontent-%COMP%]{padding:20px;margin-bottom:16px}.timer-title[_ngcontent-%COMP%]{font-size:1.2rem}.timer-display[_ngcontent-%COMP%]{font-size:2.5rem}.session-only[_ngcontent-%COMP%]{padding:32px 20px!important;min-height:280px}}@media(max-width:576px){.session-timer-page[_ngcontent-%COMP%]{padding:1rem .75rem 4rem}.timer-card[_ngcontent-%COMP%]{padding:16px;border-radius:12px}.timer-header[_ngcontent-%COMP%]{margin-bottom:12px}.timer-title[_ngcontent-%COMP%]{font-size:1.1rem}.timer-display[_ngcontent-%COMP%]{font-size:2.4rem;letter-spacing:1px}.session-only[_ngcontent-%COMP%]{padding:24px 16px!important;min-height:240px}.session-only-timer[_ngcontent-%COMP%]{font-size:3.8rem!important;margin-top:20px;margin-bottom:20px}.task-timer-display[_ngcontent-%COMP%]{font-size:2.8rem!important}.task-select-card[_ngcontent-%COMP%]{padding:12px;margin-bottom:8px}.task-name[_ngcontent-%COMP%]{font-size:.95rem}.subtask-row[_ngcontent-%COMP%]{gap:12px;margin-bottom:12px}.subtask-label[_ngcontent-%COMP%]{font-size:.8rem}.subtask-name[_ngcontent-%COMP%]{font-size:.95rem}.subtask-timer-display[_ngcontent-%COMP%]{font-size:3.6rem!important}}"]})};export{ae as SessionFormComponent};
